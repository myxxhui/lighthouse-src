import fs from "fs";
import path from "path";
export function getInitialAssetsFromStats(outputDir) {
    const assets = { js: [], css: [] };
    const statsPath = path.join(outputDir, "stats.json");
    if (fs.existsSync(statsPath)) {
        try {
            const stats = JSON.parse(fs.readFileSync(statsPath, "utf-8"));
            if (stats.entrypoints) {
                Object.values(stats.entrypoints).forEach((entrypoint) => {
                    var _a;
                    (_a = entrypoint.assets) === null || _a === void 0 ? void 0 : _a.forEach((asset) => {
                        if (asset.name.endsWith(".js") && !assets.js.includes(asset.name)) {
                            assets.js.push(asset.name);
                        }
                        if (asset.name.endsWith(".css") &&
                            !assets.css.includes(asset.name)) {
                            assets.css.push(asset.name);
                        }
                    });
                });
            }
        }
        catch (e) {
            console.warn("Failed to read stats.json for assets discovery", e);
        }
    }
    return assets;
}
