"use strict";
import { jsx, jsxs } from "react/jsx-runtime";
import { Table, Tag, Space, Button } from "antd";
import EfficiencyChart from "@/components/EfficiencyChart";
import StatusIndicator from "@/components/StatusIndicator";
const CostTable = ({
  data,
  loading = false,
  onRowClick,
  showRecommendations = true
}) => {
  const columns = [
    {
      title: "\u547D\u540D\u7A7A\u95F4",
      dataIndex: "namespace",
      key: "namespace",
      render: (text) => /* @__PURE__ */ jsx("strong", { children: text })
    },
    {
      title: "\u6210\u672C (\xA5)",
      dataIndex: "cost",
      key: "cost",
      render: (value) => value.toLocaleString(),
      sorter: (a, b) => a.cost - b.cost
    },
    {
      title: "\u53EF\u4F18\u5316\u7A7A\u95F4 (\xA5)",
      dataIndex: "optimizableSpace",
      key: "optimizableSpace",
      render: (value) => /* @__PURE__ */ jsx(Tag, { color: "warning", children: value.toLocaleString() }),
      sorter: (a, b) => a.optimizableSpace - b.optimizableSpace
    },
    {
      title: "\u6548\u7387\u5206 (%)",
      dataIndex: "efficiency",
      key: "efficiency",
      render: (value) => /* @__PURE__ */ jsxs(Space, { children: [
        /* @__PURE__ */ jsx(EfficiencyChart, { efficiency: value, size: 40, showLabel: false }),
        /* @__PURE__ */ jsxs("span", { children: [
          value,
          "%"
        ] })
      ] }),
      sorter: (a, b) => a.efficiency - b.efficiency
    },
    {
      title: "\u8D44\u6E90\u4F7F\u7528\u7387",
      key: "resourceUsage",
      render: (_, record) => /* @__PURE__ */ jsxs(Space, { direction: "vertical", size: "small", children: [
        /* @__PURE__ */ jsxs("div", { children: [
          "CPU: ",
          record.resourceUsage.cpu,
          "%"
        ] }),
        /* @__PURE__ */ jsxs("div", { children: [
          "\u5185\u5B58: ",
          record.resourceUsage.memory,
          "%"
        ] }),
        /* @__PURE__ */ jsxs("div", { children: [
          "\u5B58\u50A8: ",
          record.resourceUsage.storage,
          "%"
        ] })
      ] })
    },
    {
      title: "\u5065\u5EB7\u72B6\u6001",
      key: "status",
      render: (_, record) => {
        let status = "healthy";
        if (record.efficiency < 50) {
          status = "critical";
        } else if (record.efficiency < 70) {
          status = "warning";
        }
        return /* @__PURE__ */ jsx(StatusIndicator, { status });
      }
    },
    {
      title: "\u64CD\u4F5C",
      key: "action",
      render: (_, record) => /* @__PURE__ */ jsx(Button, { type: "link", onClick: () => onRowClick && onRowClick(record), children: "\u8BE6\u60C5" })
    }
  ];
  const expandedRowRender = (record) => {
    if (!showRecommendations || !record.recommendations?.length) {
      return null;
    }
    return /* @__PURE__ */ jsxs("div", { style: { padding: "16px 0" }, children: [
      /* @__PURE__ */ jsx("h4", { children: "\u4F18\u5316\u5EFA\u8BAE:" }),
      /* @__PURE__ */ jsx("ul", { children: record.recommendations.map((rec, index) => /* @__PURE__ */ jsx("li", { children: rec }, index)) })
    ] });
  };
  return /* @__PURE__ */ jsx(
    Table,
    {
      dataSource: data,
      columns,
      loading,
      rowKey: "namespace",
      onRow: (record) => ({
        onClick: () => onRowClick && onRowClick(record)
      }),
      expandable: {
        expandedRowRender,
        rowExpandable: (record) => showRecommendations && !!record.recommendations?.length
      },
      pagination: {
        pageSize: 10,
        showSizeChanger: true,
        pageSizeOptions: ["10", "20", "50"]
      }
    }
  );
};
export default CostTable;
