"use strict";(self.webpackChunklighthouse_web=self.webpackChunklighthouse_web||[]).push([[21],{12021:function(K,M,d){d.d(M,{q:function(){return J}});var D=d(19632),C=d.n(D),O=d(15009),i=d.n(O),y=d(99289),m=d.n(y),N=d(64529),P=d(782),R=d(12444),I=d.n(R),L=d(72004),T=d.n(L),z=d(9783),G=d.n(z),$=d(54683),E={NODE_ENV:"production",PUBLIC_PATH:"/"}.API_BASE_URL||"/api",A=function(){function l(){I()(this,l),G()(this,"client",void 0),this.client=$.Z.create({baseURL:E,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(function(n){return n},function(n){return Promise.reject(n)}),this.client.interceptors.response.use(function(n){return n},function(n){var r,t,a={message:((r=n.response)===null||r===void 0||(r=r.data)===null||r===void 0?void 0:r.message)||n.message||"\u672A\u77E5\u9519\u8BEF",code:((t=n.response)===null||t===void 0||(t=t.data)===null||t===void 0?void 0:t.code)||"UNKNOWN_ERROR",timestamp:new Date().toISOString()};return Promise.reject(a)})}return T()(l,[{key:"get",value:function(r,t){return this.client.get(r,t)}},{key:"post",value:function(r,t,a){return this.client.post(r,t,a)}},{key:"put",value:function(r,t,a){return this.client.put(r,t,a)}},{key:"delete",value:function(r,t){return this.client.delete(r,t)}}]),l}(),v=new A;function U(l){var n,r,t,a,o=(n=l.total_optimizable)!==null&&n!==void 0?n:l.total_cost*.3,s=(r=l.global_efficiency)!==null&&r!==void 0?r:70,u=l.total_cost||1,p=(t=(a=l.domain_breakdown)===null||a===void 0?void 0:a.map(function(f){return{domain:f.domain,cost:f.cost,optimizableSpace:f.optimizable_space,efficiency:f.efficiency}}))!==null&&t!==void 0?t:l.namespaces.map(function(f){var e;return{domain:f.name,cost:f.cost,optimizableSpace:o*(f.cost/u)||0,efficiency:k((e=f.grade)!==null&&e!==void 0?e:"Healthy")}});return{totalBillableCost:l.total_cost,totalOptimizableSpace:o,globalEfficiency:s,domainBreakdown:p}}function W(l){return l.map(function(n){var r,t=k((r=n.grade)!==null&&r!==void 0?r:"Healthy"),a=1-t/100;return{namespace:n.name,cost:n.cost,optimizableSpace:n.cost*a||0,efficiency:t,resourceUsage:{cpu:0,memory:0,storage:0},recommendations:[]}})}function k(l){switch(l){case"Zombie":return 10;case"OverProvisioned":return 40;case"Healthy":return 70;case"Risk":return 90;default:return 70}}var w="/v1/cost",g={getGlobalCostMetrics:function(){return m()(i()().mark(function n(){var r;return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v.get("".concat(w,"/global"));case 3:return r=a.sent,a.abrupt("return",U(r.data));case 7:throw a.prev=7,a.t0=a.catch(0),console.error("Failed to fetch global cost metrics:",a.t0),a.t0;case 11:case"end":return a.stop()}},n,null,[[0,7]])}))()},getNamespaceCosts:function(){return m()(i()().mark(function n(){var r;return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v.get("".concat(w,"/namespaces"));case 3:return r=a.sent,a.abrupt("return",W(r.data));case 7:throw a.prev=7,a.t0=a.catch(0),console.error("Failed to fetch namespace costs:",a.t0),a.t0;case 11:case"end":return a.stop()}},n,null,[[0,7]])}))()},getDrilldownData:function(n,r){return m()(i()().mark(function t(){var a;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,v.get("".concat(w,"/drilldown/").concat(n,"/").concat(r));case 3:return a=s.sent,s.abrupt("return",a.data);case 7:throw s.prev=7,s.t0=s.catch(0),console.error("Failed to fetch drilldown data for ".concat(n," ").concat(r,":"),s.t0),s.t0;case 11:case"end":return s.stop()}},t,null,[[0,7]])}))()},getSLOStatus:function(){return m()(i()().mark(function n(){var r,t,a;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,v.get("/v1/slo/health");case 3:return t=s.sent,a=t.data,s.abrupt("return",Array.isArray(a)?a:(r=a==null?void 0:a.items)!==null&&r!==void 0?r:[]);case 8:throw s.prev=8,s.t0=s.catch(0),console.error("Failed to fetch SLO status:",s.t0),s.t0;case 12:case"end":return s.stop()}},n,null,[[0,8]])}))()},getROITrends:function(){return m()(i()().mark(function n(){var r,t,a;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,v.get("/v1/roi/dashboard");case 3:return t=s.sent,a=t.data,s.abrupt("return",Array.isArray(a)?a:(r=a==null?void 0:a.trends)!==null&&r!==void 0?r:[]);case 8:throw s.prev=8,s.t0=s.catch(0),console.error("Failed to fetch ROI trends:",s.t0),s.t0;case 12:case"end":return s.stop()}},n,null,[[0,8]])}))()}},B=function(){return{totalBillableCost:125e3,totalOptimizableSpace:37500,globalEfficiency:70,domainBreakdown:[{domain:"\u8BA1\u7B97\u8D44\u6E90",cost:85e3,optimizableSpace:25500,efficiency:70},{domain:"\u5B58\u50A8\u8D44\u6E90",cost:25e3,optimizableSpace:7500,efficiency:70},{domain:"\u7F51\u7EDC\u8D44\u6E90",cost:15e3,optimizableSpace:4500,efficiency:70}]}},F=function(){return[{namespace:"production",cost:65e3,optimizableSpace:19500,efficiency:70,resourceUsage:{cpu:65,memory:72,storage:58},recommendations:["\u4F18\u5316Pod\u8D44\u6E90\u914D\u7F6E","\u5408\u5E76\u76F8\u4F3C\u5DE5\u4F5C\u8D1F\u8F7D"]},{namespace:"staging",cost:35e3,optimizableSpace:10500,efficiency:70,resourceUsage:{cpu:45,memory:52,storage:62},recommendations:["\u51CF\u5C11\u526F\u672C\u6570\u91CF","\u4F18\u5316\u5B58\u50A8\u4F7F\u7528"]},{namespace:"development",cost:25e3,optimizableSpace:7500,efficiency:70,resourceUsage:{cpu:35,memory:42,storage:55},recommendations:["\u6E05\u7406\u672A\u4F7F\u7528\u7684\u8D44\u6E90","\u4F18\u5316\u5F00\u53D1\u73AF\u5883\u914D\u7F6E"]}]},H=function(n,r){var t={id:r,name:"".concat(n,"-").concat(r),type:n,cost:Math.random()*1e4+1e3,optimizableSpace:Math.random()*3e3+300,efficiency:Math.floor(Math.random()*30)+70};return n==="namespace"&&(t.children=[{id:"node-1",name:"node-1",type:"node",cost:5e3,optimizableSpace:1500,efficiency:70,children:[{id:"workload-1",name:"workload-1",type:"workload",cost:2500,optimizableSpace:750,efficiency:70,children:[{id:"pod-1",name:"pod-1",type:"pod",cost:1250,optimizableSpace:375,efficiency:70}]}]}]),t},j=function(){return[{serviceName:"api-gateway",status:"healthy",uptime:99.95,responseTime:120,errorRate:.02},{serviceName:"auth-service",status:"warning",uptime:99.85,responseTime:250,errorRate:.15},{serviceName:"payment-service",status:"critical",uptime:98.5,responseTime:850,errorRate:2.3}]},Z=function(){for(var n=[],r=new Date,t=30;t>=0;t--){var a=new Date(r);a.setDate(a.getDate()-t);var o=a.toISOString().split("T")[0];n.push({date:o,value:Math.random()*1e5+5e4,cost:Math.random()*8e4+2e4,efficiency:Math.floor(Math.random()*30)+70})}return n},h={getGlobalCostMetrics:function(){return Promise.resolve(B())},getNamespaceCosts:function(){return Promise.resolve(F())},getDrilldownData:function(n,r){return Promise.resolve(H(n,r))},getSLOStatus:function(){return Promise.resolve(j())},getROITrends:function(){return Promise.resolve(Z())}},J=(0,N.Ue)()((0,P.tJ)(function(l,n){return{globalCostMetrics:null,loadingGlobalMetrics:!1,errorGlobalMetrics:null,namespaceCosts:null,loadingNamespaceCosts:!1,errorNamespaceCosts:null,currentDrilldownItem:null,drilldownPath:[],loadingDrilldown:!1,errorDrilldown:null,sloStatus:null,loadingSLO:!1,errorSLO:null,roiTrends:null,loadingROI:!1,errorROI:null,useMockData:!0,selectedNamespace:null,selectedNode:null,selectedWorkload:null,selectedPod:null,fetchGlobalCostMetrics:function(){var r=m()(i()().mark(function a(){var o,s,u,p;return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n(),s=o.useMockData,l({loadingGlobalMetrics:!0,errorGlobalMetrics:null}),e.prev=2,!s){e.next=9;break}return e.next=6,h.getGlobalCostMetrics();case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,g.getGlobalCostMetrics();case 11:e.t0=e.sent;case 12:u=e.t0,l({globalCostMetrics:u,loadingGlobalMetrics:!1}),e.next=20;break;case 16:e.prev=16,e.t1=e.catch(2),p=e.t1 instanceof Error?e.t1.message:"\u83B7\u53D6\u5168\u5C40\u6210\u672C\u6307\u6807\u5931\u8D25",l({errorGlobalMetrics:p,loadingGlobalMetrics:!1});case 20:case"end":return e.stop()}},a,null,[[2,16]])}));function t(){return r.apply(this,arguments)}return t}(),fetchNamespaceCosts:function(){var r=m()(i()().mark(function a(){var o,s,u,p;return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n(),s=o.useMockData,l({loadingNamespaceCosts:!0,errorNamespaceCosts:null}),e.prev=2,!s){e.next=9;break}return e.next=6,h.getNamespaceCosts();case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,g.getNamespaceCosts();case 11:e.t0=e.sent;case 12:u=e.t0,l({namespaceCosts:u,loadingNamespaceCosts:!1}),e.next=20;break;case 16:e.prev=16,e.t1=e.catch(2),p=e.t1 instanceof Error?e.t1.message:"\u83B7\u53D6\u547D\u540D\u7A7A\u95F4\u6210\u672C\u5931\u8D25",l({errorNamespaceCosts:p,loadingNamespaceCosts:!1});case 20:case"end":return e.stop()}},a,null,[[2,16]])}));function t(){return r.apply(this,arguments)}return t}(),fetchDrilldownData:function(){var r=m()(i()().mark(function a(o,s){var u,p,f,e,b,S;return i()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(u=n(),p=u.useMockData,f=u.drilldownPath,l({loadingDrilldown:!0,errorDrilldown:null}),c.prev=2,!p){c.next=9;break}return c.next=6,h.getDrilldownData(o,s);case 6:c.t0=c.sent,c.next=12;break;case 9:return c.next=11,g.getDrilldownData(o,s);case 11:c.t0=c.sent;case 12:e=c.t0,b=[].concat(C()(f),["".concat(o,":").concat(s)]),l({currentDrilldownItem:e,drilldownPath:b,loadingDrilldown:!1}),o==="namespace"?l({selectedNamespace:s,selectedNode:null,selectedWorkload:null,selectedPod:null}):o==="node"?l({selectedNode:s,selectedWorkload:null,selectedPod:null}):o==="workload"?l({selectedWorkload:s,selectedPod:null}):o==="pod"&&l({selectedPod:s}),c.next=22;break;case 18:c.prev=18,c.t1=c.catch(2),S=c.t1 instanceof Error?c.t1.message:"\u83B7\u53D6\u94BB\u53D6\u6570\u636E\u5931\u8D25",l({errorDrilldown:S,loadingDrilldown:!1});case 22:case"end":return c.stop()}},a,null,[[2,18]])}));function t(a,o){return r.apply(this,arguments)}return t}(),fetchSLOStatus:function(){var r=m()(i()().mark(function a(){var o,s,u,p;return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n(),s=o.useMockData,l({loadingSLO:!0,errorSLO:null}),e.prev=2,!s){e.next=9;break}return e.next=6,h.getSLOStatus();case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,g.getSLOStatus();case 11:e.t0=e.sent;case 12:u=e.t0,l({sloStatus:u,loadingSLO:!1}),e.next=20;break;case 16:e.prev=16,e.t1=e.catch(2),p=e.t1 instanceof Error?e.t1.message:"\u83B7\u53D6SLO\u72B6\u6001\u5931\u8D25",l({errorSLO:p,loadingSLO:!1});case 20:case"end":return e.stop()}},a,null,[[2,16]])}));function t(){return r.apply(this,arguments)}return t}(),fetchROITrends:function(){var r=m()(i()().mark(function a(){var o,s,u,p;return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n(),s=o.useMockData,l({loadingROI:!0,errorROI:null}),e.prev=2,!s){e.next=9;break}return e.next=6,h.getROITrends();case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,g.getROITrends();case 11:e.t0=e.sent;case 12:u=e.t0,l({roiTrends:u,loadingROI:!1}),e.next=20;break;case 16:e.prev=16,e.t1=e.catch(2),p=e.t1 instanceof Error?e.t1.message:"\u83B7\u53D6ROI\u8D8B\u52BF\u5931\u8D25",l({errorROI:p,loadingROI:!1});case 20:case"end":return e.stop()}},a,null,[[2,16]])}));function t(){return r.apply(this,arguments)}return t}(),setUseMockData:function(t){l({useMockData:t})},setSelectedNamespace:function(t){l({selectedNamespace:t})},setSelectedNode:function(t){l({selectedNode:t})},setSelectedWorkload:function(t){l({selectedWorkload:t})},setSelectedPod:function(t){l({selectedPod:t})},clearDrilldownPath:function(){l({drilldownPath:[],currentDrilldownItem:null,selectedNamespace:null,selectedNode:null,selectedWorkload:null,selectedPod:null})},resetErrors:function(){l({errorGlobalMetrics:null,errorNamespaceCosts:null,errorDrilldown:null,errorSLO:null,errorROI:null})}}},{name:"lighthouse-storage",partialize:function(n){return{useMockData:n.useMockData,selectedNamespace:n.selectedNamespace,selectedNode:n.selectedNode,selectedWorkload:n.selectedWorkload,selectedPod:n.selectedPod}}}))}}]);
